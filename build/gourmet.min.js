/*! gourmet - v0.0.1 - 2012-07-17
* Copyright (c) 2012 Claudio Ortolina; Licensed  */
window.Gourmet={Models:{},Collections:{},Views:{}};var __hasProp={}.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Gourmet.Models.Restaurant=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.urlRoot="/restaurants",b.prototype.defaults={name:null,postcode:null,rating:null},b.prototype.validate={name:{required:!0},postcode:{required:!0},rating:{required:!0,type:"number",min:1,max:5}},b}(Backbone.Model),Gourmet.Collections.RestaurantsCollection=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.url="/restaurants",b.prototype.model=Gourmet.Models.Restaurant,b}(Backbone.Collection);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Gourmet.Views.RestaurantForm=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.events={"click #save":"save"},b.prototype.save=function(){var a,b,c;return a=this.parseFormData(this.$el.serializeArray()),c=new Gourmet.Models.Restaurant(a),b=c.validate(c.attributes),b?this.handleErrors(b):this.collection.create(c)},b.prototype.parseFormData=function(a){return _.reduce(a,this.parseFormField,{})},b.prototype.parseFormField=function(a,b){var c;return c=b.name.match(/\[(\w+)\]/)[1],a[c]=b.value,a},b.prototype.handleErrors=function(a){var b,c,d,e,f;$(".control-group").removeClass("error"),e=_.keys(a),f=[];for(c=0,d=e.length;c<d;c++)b=e[c],f.push(function(b){var c,d;return c=$("#restaurant_"+b),d=a[b].join(","),c.closest(".control-group").addClass("error")}(b));return f},b}(Backbone.View);var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Gourmet.Views.RestaurantsListView=function(a){function b(){return this.removeRestaurant=__bind(this.removeRestaurant,this),this.render=__bind(this.render,this),b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.events={"click .close":"removeRestaurant"},b.prototype.template=Hogan.compile($("#restaurant-template").html()),b.prototype.initialize=function(){return this.render(this.collection),this.collection.on("add",this.render),this.collection.on("remove",this.render)},b.prototype.render=function(){var a,b,c,d,e,f=this;this.$el.empty(),d=this.collection.models,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(function(a){return f.$el.append(f.template.render(a.toJSON()))}(a));return e},b.prototype.removeRestaurant=function(a){var b,c;return b=a.target.id,c=this.collection.get(b),this.collection.remove(c),c.destroy()},b}(Backbone.View);